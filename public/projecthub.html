<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mini Project Hub - Submit & Display Projects</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8faff;
      color: #1a237e;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      padding: 2rem 1rem;
    }
    h1, h2 {
      font-weight: 700;
      margin-bottom: 1.5rem;
    }
    .project-level {
      font-weight: 700;
      color: #2563EB;
      margin-bottom: 0.25rem;
    }
    .card {
      border-radius: 0.75rem;
      box-shadow: 0 4px 12px rgb(26 35 126 / 0.15);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 20px rgb(26 35 126 / 0.25);
    }
    .card-body {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    .tech-stack {
      font-weight: 600;
      margin-top: 1rem;
      color: #374151;
    }
    .steps {
      margin-top: 0.5rem;
      color: #4B5563;
      flex-grow: 1;
    }
    .btn-link {
      font-weight: 700;
      color: #2563EB;
      text-decoration: none;
      margin-top: 1rem;
    }
    .btn-link:hover {
      text-decoration: underline;
    }
    form input, form textarea, form select {
      margin-bottom: 1rem;
    }
    .alert {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <main class="container" style="max-width: 1100px;">
    <h1 class="text-center">Mini Project Hub</h1>

    <section>
      <h2>Submit Your Project</h2>
      <form id="projectForm" novalidate>
        <div class="row g-3">
          <div class="col-md-6">
            <label for="name" class="form-label">Your Name *</label>
            <input type="text" id="name" name="name" class="form-control" placeholder="Enter your full name" required />
          </div>
          <div class="col-md-6">
            <label for="email" class="form-label">Email *</label>
            <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email" required />
          </div>
          <div class="col-md-6">
            <label for="rollNumber" class="form-label">Roll Number *</label>
            <input type="text" id="rollNumber" name="rollNumber" class="form-control" placeholder="Enter your roll number" required />
          </div>
          <div class="col-md-6">
            <label for="projectTitle" class="form-label">Project Title *</label>
            <input type="text" id="projectTitle" name="projectTitle" class="form-control" placeholder="Project title" required />
          </div>
          <div class="col-md-6">
            <label for="level" class="form-label">Difficulty Level *</label>
            <select id="level" name="level" class="form-select" required>
              <option value="" selected disabled>Select level</option>
              <option value="Beginner">Beginner</option>
              <option value="Intermediate">Intermediate</option>
              <option value="Advanced">Advanced</option>
            </select>
          </div>
          <div class="col-12">
            <label for="techStack" class="form-label">Tech Stack *</label>
            <input type="text" id="techStack" name="techStack" class="form-control" placeholder="E.g., HTML, CSS, JavaScript" required />
          </div>
          <div class="col-12">
            <label for="steps" class="form-label">Project Steps/Short Guide *</label>
            <textarea id="steps" name="steps" class="form-control" rows="4" placeholder="Brief steps of the project" required></textarea>
          </div>
          <div class="col-12">
            <label for="resourcesLink" class="form-label">GitHub / Resources URL *</label>
            <input type="url" id="resourcesLink" name="resourcesLink" class="form-control" placeholder="https://github.com/your_repo" required />
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-primary w-100">Submit Project</button>
          </div>
        </div>
      </form>
      <div id="formAlert" class="alert d-none" role="alert"></div>
    </section>

    <hr class="my-5">

    <section>
      <h2>Projects</h2>
      <div id="projectsList" class="row g-4">
        <p class="text-center text-muted">Loading projects...</p>
      </div>
    </section>
  </main>

  <!-- Firebase JS SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBjiKldk4Q-J8dEbhBd6FTGyPb-TQoGadE",
      authDomain: "st-fees.firebaseapp.com",
      projectId: "st-fees",
      storageBucket: "st-fees.firebasestorage.app",
      messagingSenderId: "865723388538",
      appId: "1:865723388538:web:e49e6bde9ff7023aae61c3",
      measurementId: "G-Y9WQXHKTX4"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const serverTimestamp = firebase.firestore.FieldValue.serverTimestamp;

    const form = document.getElementById('projectForm');
    const alertBox = document.getElementById('formAlert');
    const projectsList = document.getElementById('projectsList');

    const exampleProjects = [
      {
        name: "Admin",
        email: "admin@example.com",
        projectTitle: "To-Do List in JS",
        level: "Beginner",
        techStack: "HTML, CSS, JavaScript",
        steps: "Create layout, Add tasks input, Show list, Delete and mark tasks complete.",
        resourcesLink: "https://github.com/MatheusCavini/ReactJS-ToDoList#"
      },
      {
        name: "Admin",
        email: "admin@example.com",
        projectTitle: "QR Code Attendance System",
        level: "Intermediate",
        techStack: "Node.js, Express, MongoDB, React",
        steps: "Setup backend API, Generate QR codes, Scan and verify attendance, Store data.",
        resourcesLink: "https://github.com/Attendize/Attendize"
      },
      {
        name: "Admin",
        email: "admin@example.com",
        projectTitle: "AI Chatbot with OpenAI API",
        level: "Advanced",
        techStack: "React, Node.js, OpenAI API",
        steps: "Build frontend UI, Setup backend API integration, Connect OpenAI for responses, Add session management.",
        resourcesLink: "https://github.com/iampawan/ChatGPT-Flutter-AIChatBot"
      }
    ];

    function createProjectCard(data) {
      const col = document.createElement('div');
      col.className = 'col-md-4';

      const card = document.createElement('div');
      card.className = 'card shadow-sm h-100 d-flex flex-column';

      const cardBody = document.createElement('div');
      cardBody.className = 'card-body d-flex flex-column';

      const levelBadge = document.createElement('div');
      levelBadge.className = 'project-level text-primary mb-2';
      levelBadge.textContent = data.level;
      if (data.level === 'Beginner') levelBadge.style.color = '#22c55e';
      else if (data.level === 'Intermediate') levelBadge.style.color = '#facc15';
      else if (data.level === 'Advanced') levelBadge.style.color = '#ef4444';

      const title = document.createElement('h5');
      title.className = 'card-title';
      title.textContent = data.projectTitle;

      const techStack = document.createElement('div');
      techStack.className = 'tech-stack mt-2';
      techStack.textContent = `Tech stack: ${data.techStack}`;

      const steps = document.createElement('p');
      steps.className = 'steps';
      steps.textContent = `Steps: ${data.steps}`;

      const link = document.createElement('a');
      link.href = data.resourcesLink;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.className = 'btn-link mt-auto';
      link.textContent = 'GitHub / Resources';

      cardBody.append(levelBadge, title, techStack, steps, link);
      card.appendChild(cardBody);
      col.appendChild(card);

      return col;
    }

    function loadProjects() {
      projectsList.innerHTML = '';
      exampleProjects.forEach(proj => {
        projectsList.appendChild(createProjectCard(proj));
      });
      db.collection('miniProjects').orderBy('level').get().then(snapshot => {
        snapshot.forEach(doc => {
          projectsList.appendChild(createProjectCard(doc.data()));
        });
      }).catch(err => {
        console.error("Failed to load user projects:", err);
      });
    }

    function showAlert(message, type = 'success') {
      alertBox.textContent = message;
      alertBox.className = `alert alert-${type}`;
      alertBox.classList.remove('d-none');
      setTimeout(() => {
        alertBox.classList.add('d-none');
      }, 4000);
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const name = form.name.value.trim();
      const email = form.email.value.trim();
      const rollNumber = form.rollNumber.value.trim();
      const projectTitle = form.projectTitle.value.trim();
      const level = form.level.value;
      const techStack = form.techStack.value.trim();
      const steps = form.steps.value.trim();
      const resourcesLink = form.resourcesLink.value.trim();

      if (!name || !email || !rollNumber || !projectTitle || !level || !techStack || !steps || !resourcesLink) {
        showAlert('Please fill in all required fields.', 'danger');
        return;
      }

      // Save with rollNumber as document ID
      db.collection('miniProjects').doc(rollNumber).set({
        name,
        email,
        rollNumber,
        projectTitle,
        level,
        techStack,
        steps,
        resourcesLink,
        submittedAt: serverTimestamp()
      }).then(() => {
        showAlert('Project submitted successfully! Thank you.');
        form.reset();
        loadProjects();
      }).catch(err => {
        console.error("Error submitting project:", err);
        showAlert('Failed to submit project. Please try again.', 'danger');
      });
    });

    window.onload = loadProjects;
  </script>
  <!-- Bootstrap 5 JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
