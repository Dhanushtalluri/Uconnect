<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>UConnect - Student Notifications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Firebase Modular v10+ (compat mode for timestamp .toDate) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f7fd;
      margin: 0;
      min-height: 100vh;
    }
    header {
      display: flex;
      align-items: center;
      background: #21294c;
      color: #fff;
      padding: 10px 18px 10px 12px;
      box-shadow: 0 2px 10px #4153aa1a;
      gap: 12px;
    }
    .home-link {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: #fff;
      font-size: 1.24rem;
      transition: color 0.15s;
      font-weight: 500;
    }
    .home-link:hover { color: #f7b731; }
    .home-link svg {
      width: 27px; height: 27px; margin-right: 7px; fill: #fff; vertical-align: middle;
      transition: fill 0.18s;
    }
    .logo {
      width: 44px;
      height: 44px;
      object-fit: contain;
      margin-left: 8px;
    }
    .title {
      font-size: 1.48rem;
      font-weight: bold;
      letter-spacing: 1.7px;
      margin-left: 9px;
      color: #f7b731;
    }
    main {
      max-width: 450px;
      margin: 32px auto;
      background: #fff;
      border-radius: 13px;
      box-shadow: 0 8px 28px #c7e1f8a2;
      padding: 23px 15px 27px 17px;
    }
    h2 {color:#384fe8;margin:10px 0 25px 0;}
    .notif-list { list-style: none; padding: 0; margin: 0;}
    .card-notif {
      margin-bottom: 15px;
      background: #f2f6ff;
      border-left: 6px solid #384fe8;
      border-radius: 9px;
      padding: 13px 15px 10px 15px;
      box-shadow:0 1.5px 12px #cfe0ff22;
    }
    .notif-title { font-weight: 700; font-size:1.12em; color: #283185; margin-bottom: 5px;}
    .notif-msg { margin-bottom:5px; color: #34364d; }
    .notif-time { color:#566; font-size: 0.93em; text-align:right;}
    @media (max-width: 600px) {
      header { padding:8px 5vw 8px 2vw; }
      main { max-width: 99vw; padding: 14px 3vw;}
      .logo { width:34px; height:34px;}
      .title { font-size: 1.05rem; }
    }
  </style>
</head>
<body>
  <header>
    <a href="student.html" class="home-link" aria-label="Home">
      <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      Home
    </a>
    <img class="logo" src="https://res.cloudinary.com/drax7i59f/image/upload/v1756406583/U-p_ndview.png" alt="UConnect Logo" />
    <div class="title">U Connect</div>
  </header>
  <main>
    <h2>Notifications</h2>
    <ul id="notifList" class="notif-list">
      <li>Loading notifications...</li>
    </ul>
  </main>
<script>
 // For Firebase JS SDK v7.20.0 and later, measurementId is optional
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBjiKldk4Q-J8dEbhBd6FTGyPb-TQoGadE",
  authDomain: "st-fees.firebaseapp.com",
  projectId: "st-fees",
  storageBucket: "st-fees.firebasestorage.app",
  messagingSenderId: "865723388538",
  appId: "1:865723388538:web:e49e6bde9ff7023aae61c3",
  measurementId: "G-Y9WQXHKTX4"
};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Student login â€” replace with real auth logic!
  const currentStudentId = "student1"; // change as needed

  const notifList = document.getElementById('notifList');
  db.collection("notifications").orderBy("timestamp", "desc")
    .onSnapshot(snapshot => {
      let found = false;
      notifList.innerHTML = "";
      snapshot.forEach(doc => {
        const n = doc.data();
        if (n.to === "all" || n.to === currentStudentId) {
          found = true;
          let time = n.timestamp && typeof n.timestamp.toDate === "function"
            ? n.timestamp.toDate().toLocaleString()
            : "Unknown time";
          notifList.innerHTML += `
            <li class="card-notif">
              <div class="notif-title">${n.title}</div>
              <div class="notif-msg">${n.message}</div>
              <div class="notif-time">${time}</div>
            </li>
          `;
        }
      });
      if (!found) notifList.innerHTML = "<li>No notifications to show.</li>";
    }, err => {
      notifList.innerHTML = `<li style="color:red;">Error loading notifications.<br>${err.message}</li>`;
    });
</script>
</body>
</html>
